<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OpenLayers - Playgrounds Example</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/ol@v7.3.0/ol.css"
    />
    <style>
      html,
      body,
      #map {
        margin: 0;
        height: 100%;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script src="https://cdn.jsdelivr.net/npm/ol@v7.3.0/dist/ol.js"></script>
    <script>
      const layerNameSet = new Set([]);
      window._layers = layerNameSet;
      const roadStyleCache = {};
      const roadColor = {
        major_road: "#776",
        minor_road: "#ccb",
        highway: "#f39",
      };
      const buildingStyle = new ol.style.Style({
        fill: new ol.style.Fill({
          color: "#666",
          opacity: 0.4,
        }),
        stroke: new ol.style.Stroke({
          color: "#444",
          width: 1,
        }),
      });
      const placeStyle = new ol.style.Style({
        fill: new ol.style.Fill({
          color: "#ffcc00",
          opacity: 0.4,
        }),
        stroke: new ol.style.Stroke({
          color: "#444",
          width: 1,
        }),
      });
      const landcoverStyle = new ol.style.Style({
        fill: new ol.style.Fill({
          color: "#22b922",
        }),
      });
      const landuseStyle = new ol.style.Style({
        fill: new ol.style.Fill({
          color: "#d4f4d5",
        }),
      });
      const boundaryStyle = new ol.style.Style({
        fill: new ol.style.Fill({
          color: "#ffcc00",
          opacity: 0.4,
        }),
        stroke: new ol.style.Stroke({
          color: "#444",
          width: 1,
        }),
      });      const waterStyle = new ol.style.Style({
        fill: new ol.style.Fill({
          color: "#9db9e8",
        }),
      });
      const transportationStyle = new ol.style.Style({
        fill: new ol.style.Fill({
          color: "#f39",
        }),
      });
      const roadStyle = function (feature) {
        const kind = feature.get("kind");
        const railway = feature.get("railway");
        const sort_key = feature.get("sort_key");
        const styleKey = kind + "/" + railway + "/" + sort_key;
        let style = roadStyleCache[styleKey];
        if (!style) {
          let color, width;
          if (railway) {
            color = "#7de";
            width = 1;
          } else {
            color = roadColor[kind];
            width = kind == "highway" ? 1.5 : 1;
          }
          style = new ol.style.Style({
            stroke: new os.style.Stroke({
              color: color,
              width: width,
            }),
            zIndex: sort_key,
          });
          roadStyleCache[styleKey] = style;
        }
        return style;
      };

      const map = new ol.Map({
        layers: [
          new ol.layer.VectorTile({
            source: new ol.source.VectorTile({
              attributions:
                "&copy; OpenStreetMap contributors, Whoâ€™s On First, " +
                "Natural Earth, and osmdata.openstreetmap.de",
              format: new ol.format.GeoJSON({
                layerName: "layer",
                layers: ["water", "landcover", "roads", "building"],
              }),
              maxZoom: 14,
              url: "http://localhost:8090/data/v3/{z}/{x}/{y}.geojson",
            }),
            style: function (feature, resolution) {
              layerNameSet.add(feature.get("layer"));
              switch (feature.get("layer")) {
                case "water":
                  return waterStyle;
                case "roads":
                  return roadStyle(feature);
                case "building":
                  return resolution < 10 ? buildingStyle : null;
                case "landcover":
                  return landcoverStyle;
                case "landuse":
                  return landuseStyle;
                case "transportation":
                  return transportationStyle;
                case "place":
                  return placeStyle;
                case "boundary":
                  return boundaryStyle;
                default:
                  return null;
              }
            },
          }),
        ],
        target: "map",
        view: new ol.View({
          center: ol.proj.fromLonLat([126.996771, 37.553012]),
          zoom: 12,
        }),
      });
    </script>
  </body>
</html>
